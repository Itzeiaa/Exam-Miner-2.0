<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Google Form-like Exam Preview</title>
<style>
  :root{
    --bg1:#1e3a8a; --bg2:#3b82f6; --bg3:#60a5fa; --bg4:#93c5fd; --bg5:#1e40af; --bg6:#1d4ed8;
    --text:#0f172a; --muted:#64748b; --border:#e5e7eb; --card:#ffffff;
    --accent:#3b82f6; --accent2:#2563eb; --ok:#16a34a; --err:#dc2626;
    --radius:14px;
  }
  @keyframes gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
  *{box-sizing:border-box;margin:0}
  html,body{height:100%}
  body{
    font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    color:var(--text);
    background:linear-gradient(-45deg,var(--bg1),var(--bg2),var(--bg3),var(--bg4),var(--bg5),var(--bg6));
    background-size:400% 400%;animation:gradientShift 15s ease infinite;
    display:flex;align-items:center;justify-content:center;padding:24px;
  }
  .card{
    width:100%;max-width:800px;background:var(--card);
    border:1px solid var(--border);border-radius:var(--radius);
    box-shadow:0 10px 30px rgba(2,8,23,.08);
    padding:28px;overflow-y:auto;max-height:95vh;
  }
  .title{font-size:24px;font-weight:700;margin-bottom:8px;text-align:center}
  .subtitle{color:var(--muted);font-size:14px;margin-bottom:20px;text-align:center}
  textarea{
    width:100%;height:200px;padding:12px;border:1px solid var(--border);border-radius:10px;
    resize:vertical;font-family:monospace;font-size:14px;background:#f8fafc;
    color:var(--text);margin-bottom:10px;
  }
  .btn{
    appearance:none;border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer;
    background:linear-gradient(135deg,var(--accent),var(--accent2));color:#fff;
    transition:transform .15s,box-shadow .2s;
    box-shadow:0 8px 20px rgba(59,130,246,.25);margin-bottom:20px;
  }
  .btn:hover{transform:translateY(-1px)}
  .question{margin-bottom:20px;padding:16px;border:1px solid var(--border);
    border-radius:12px;background:#f9fafb}
  .question-title{font-weight:600;margin-bottom:8px}
  .option{margin-left:16px;margin-bottom:6px;display:flex;align-items:center;gap:6px}
  img{max-width:100%;border-radius:10px;margin-top:8px;margin-bottom:8px;border:1px solid var(--border)}
</style>
</head>
<body>
<div class="card">
  <div class="title" id="examTitle">Exam Title</div>
  <div class="subtitle">Paste your exam HTML (from database) below and click "Render Exam".</div>

  <textarea id="examText" placeholder="Paste HTML here..."></textarea>
  <button class="btn" id="renderBtn">Render Exam</button>

  <div id="examContainer"></div>
</div>

<script>
function renderExamFromHTML(htmlText){
  const container = document.getElementById("examContainer");
  container.innerHTML = "";
  const parser = new DOMParser();
  const doc = parser.parseFromString(htmlText,"text/html");

  // Extract title (first centered bold div)
  const titleDiv = doc.querySelector("div[style*='text-align:center']");
  document.getElementById("examTitle").textContent = titleDiv ? titleDiv.textContent.trim() : "Untitled Exam";

  // Extract question blocks
  const allDivs = [...doc.querySelectorAll("div[style]")];
  let i = 0;
  while (i < allDivs.length) {
    const div = allDivs[i];
    const text = div.innerText.trim();

    // Detect a question: starts with number + period (e.g., 1.)
    if (/^\d+\./.test(text)) {
      const qDiv = document.createElement("div");
      qDiv.className = "question";

      const qTitle = document.createElement("div");
      qTitle.className = "question-title";
      qTitle.textContent = text;
      qDiv.appendChild(qTitle);

      const img = div.querySelector("img");
      if (img) {
        const clone = img.cloneNode(true);
        qDiv.appendChild(clone);
      }

      // Collect next divs as choices (A., B., C., D.)
      let j = i + 1;
      while (j < allDivs.length && /^[A-D]\./.test(allDivs[j].innerText.trim())) {
        const choiceText = allDivs[j].innerText.trim();
        const opt = document.createElement("div");
        opt.className = "option";
        const radio = document.createElement("input");
        radio.type = "radio";
        radio.name = "q" + i;
        radio.value = choiceText;
        const label = document.createElement("label");
        label.textContent = choiceText;
        opt.appendChild(radio);
        opt.appendChild(label);
        qDiv.appendChild(opt);
        j++;
      }
      container.appendChild(qDiv);
      i = j;
    } else i++;
  }

  if (!container.children.length) {
    container.innerHTML = `<div style="color:var(--muted)">⚠️ No questions detected. Check your pasted structure.</div>`;
  }
}

document.getElementById("renderBtn").addEventListener("click", () => {
  const text = document.getElementById("examText").value.trim();
  if (!text) {
    alert("Paste your exam HTML first!");
    return;
  }
  renderExamFromHTML(text);
});
</script>
</body>
</html>
